import{s as g,E as h,h as M}from"./socket.8b56a9f2.js";import{_ as F,e as x,f as w,E as O,g as U,h as B,j as I,o as d,c as l,a as s,k as a,l as f,n as D,t as p,d as u,F as A,r as N,w as y,v,p as V,m as Y}from"./index.7e543e42.js";const q={name:"Events",components:{Form:x,Field:w,ErrorMessage:O},data(){const e=U().shape({name:B().required("Name is required!"),description:B()});return{events:[],invitations:[],isCreationOfEventActive:!1,loading:!1,message:"",eventSchema:e}},mounted(){g.connect(),h.getEvents().then(e=>{this.events=e.data.events,console.log(e.data)},e=>{this.content=e.response&&e.response.data&&e.response.data.message||e.message||e.toString()}),h.getInvitations().then(e=>{this.invitations=e.data.invitations,console.log(e.data)},e=>{this.content=e.response&&e.response.data&&e.response.data.message||e.message||e.toString()})},methods:{getMoment(e){return M(e).calendar()},handleCreation(e){this.loading=!0,h.createEvent(e).then(t=>{this.events.push(t.data.event),this.isCreationOfEventActive=!1,this.loading=!1},t=>{this.loading=!1,this.message=t.response&&t.response.data&&t.response.data.message||t.message||t.toString()})},handleUpdatingInvitationCanNot(e,t){t.canNotButtonLoading=!0,t.status===null&&(t.status={}),console.log(e,t),e.statusId=+e.canNotStatusId,h.updateInvitationEvent(t.event.id,t.id,e).then(c=>{t.status.id=c.data.invitation.status.id,g.emit("change card",{content:c.data.invitation.status,to:t.id}),t.canNotButtonLoading=!1},()=>{t.canNotButtonLoading=!1,alert("could not change status, try again")})},handleUpdatingInvitationMostLikely(e,t){t.mostLikelyButtonLoading=!0,t.status===null&&(t.status={}),console.log(e,t),e.statusId=+e.mostLikelyStatusId,h.updateInvitationEvent(t.event.id,t.id,e).then(c=>{t.status.id=c.data.invitation.status.id,g.emit("change card",{content:c.data.invitation.status,to:t.id}),t.mostLikelyButtonLoading=!1},()=>{t.mostLikelyButtonLoading=!1,alert("could not change status, try again")})},handleUpdatingInvitationDefinitelyAttend(e,t){t.definitelyAttendButtonLoading=!0,t.status===null&&(t.status={}),console.log(e,t),e.statusId=+e.definitelyAttendStatusId,h.updateInvitationEvent(t.event.id,t.id,e).then(c=>{t.status.id=c.data.invitation.status.id,g.emit("change card",{content:c.data.invitation.status,to:t.id}),t.definitelyAttendButtonLoading=!1},()=>{t.definitelyAttendButtonLoading=!1,alert("could not change status, try again")})}},destroyed(){g.disconnect()}},r=e=>(V("data-v-19d6d3b4"),e=e(),Y(),e),j={class:"container"},z={key:0},G={class:"col-md-12"},H={class:"card card-container"},J={class:"form-group"},K=r(()=>s("label",{for:"name"},"Name of event",-1)),P={class:"form-group"},Q=r(()=>s("label",{for:"description"},"description",-1)),R={class:"form-group"},T=r(()=>s("label",{for:"date"},"description",-1)),W={class:"form-group"},X=["disabled"],Z={class:"spinner-border spinner-border-sm"},$=r(()=>s("span",null,"Create event",-1)),tt={key:1},et=r(()=>s("h3",null,"Events",-1)),st={class:"list-group"},nt=["onClick"],ot=r(()=>s("h3",null,"Invitations to you",-1)),at={class:"list-group"},dt={key:0},lt={key:0,style:{color:"red"}},it={key:1,style:{color:"orange"}},ct={key:2,style:{color:"limegreen"}},rt={class:"form-group"},ut={class:"form-group"},_t=["disabled"],mt={class:"spinner-border spinner-border-sm"},ht=r(()=>s("span",null,"Can not",-1)),gt={class:"form-group"},pt={class:"form-group"},bt=["disabled"],ft={class:"spinner-border spinner-border-sm"},yt=r(()=>s("span",null,"Most Likely",-1)),vt={class:"form-group"},kt={class:"form-group"},Lt=["disabled"],St={class:"spinner-border spinner-border-sm"},It=r(()=>s("span",null,"Definitely Attend",-1));function Ct(e,t,c,Et,i,_){const m=I("Field"),k=I("ErrorMessage"),b=I("Form");return d(),l("div",j,[i.isCreationOfEventActive?(d(),l("div",z,[s("div",G,[s("div",H,[a(b,{onSubmit:_.handleCreation,"validation-schema":i.eventSchema},{default:f(()=>[s("div",J,[K,a(m,{name:"name",type:"text",class:"form-control"}),a(k,{name:"name",class:"error-feedback"})]),s("div",P,[Q,a(m,{name:"description",type:"text",class:"form-control"}),a(k,{name:"description",class:"error-feedback"})]),s("div",R,[T,a(m,{name:"date",type:"datetime-local",class:"form-control"}),a(k,{name:"date",class:"error-feedback"})]),s("div",W,[s("button",{class:"btn btn-primary btn-block",disabled:i.loading},[y(s("span",Z,null,512),[[v,i.loading]]),$],8,X)])]),_:1},8,["onSubmit","validation-schema"]),i.message?(d(),l("div",{key:0,class:D(["alert","alert-danger"])},p(i.message),1)):u("",!0),s("button",{class:"btn btn-danger btn-block",onClick:t[0]||(t[0]=n=>i.isCreationOfEventActive=!1)},"Cancel")])])])):u("",!0),i.isCreationOfEventActive?u("",!0):(d(),l("div",tt,[et,s("button",{class:"btn btn-primary btn-block",onClick:t[1]||(t[1]=n=>i.isCreationOfEventActive=!0)},"Create Event"),s("ul",st,[(d(!0),l(A,null,N(i.events,(n,L)=>(d(),l("li",{class:"list-group-item",key:L},[s("p",null,p(n.name),1),s("p",null,p(_.getMoment(n.date)),1),s("button",{class:"btn btn-primary btn-block",onClick:S=>this.$router.push(`/events/${n.id}`)},"Change",8,nt)]))),128))]),ot,s("ul",at,[(d(!0),l(A,null,N(i.invitations,(n,L)=>{var S,C,E;return d(),l("li",{class:"list-group-item",key:L},[s("p",null,p(n.event.name),1),s("p",null,p(_.getMoment(n.event.date)),1),n.status?(d(),l("div",dt,[((S=n.status)==null?void 0:S.id)===2?(d(),l("p",lt,"You refused")):u("",!0),((C=n.status)==null?void 0:C.id)===3?(d(),l("p",it,"You are not sure")):u("",!0),((E=n.status)==null?void 0:E.id)===4?(d(),l("p",ct,"You agreed")):u("",!0)])):u("",!0),a(b,{onSubmit:o=>_.handleUpdatingInvitationCanNot(o,n)},{default:f(()=>{var o;return[s("div",rt,[a(m,{name:"canNotStatusId",style:{visibility:"hidden"},value:"2"})]),s("div",ut,[s("button",{class:"btn btn-danger btn-block",disabled:n.canNotButtonLoading||((o=n.status)==null?void 0:o.id)===2},[y(s("span",mt,null,512),[[v,n.canNotButtonLoading]]),ht],8,_t)])]}),_:2},1032,["onSubmit"]),a(b,{onSubmit:o=>_.handleUpdatingInvitationMostLikely(o,n)},{default:f(()=>{var o;return[s("div",gt,[a(m,{name:"mostLikelyStatusId",style:{visibility:"hidden"},value:"3"})]),s("div",pt,[s("button",{class:"btn btn-warning btn-block",disabled:n.mostLikelyButtonLoading||((o=n.status)==null?void 0:o.id)===3},[y(s("span",ft,null,512),[[v,n.mostLikelyButtonLoading]]),yt],8,bt)])]}),_:2},1032,["onSubmit"]),a(b,{onSubmit:o=>_.handleUpdatingInvitationDefinitelyAttend(o,n)},{default:f(()=>{var o;return[s("div",vt,[a(m,{name:"definitelyAttendStatusId",style:{visibility:"hidden"},value:"4"})]),s("div",kt,[s("button",{class:"btn btn-success btn-block",disabled:n.definitelyAttendButtonLoading||((o=n.status)==null?void 0:o.id)===4},[y(s("span",St,null,512),[[v,n.definitelyAttendButtonLoading]]),It],8,Lt)])]}),_:2},1032,["onSubmit"])])}),128))])]))])}var Nt=F(q,[["render",Ct],["__scopeId","data-v-19d6d3b4"]]);export{Nt as default};
