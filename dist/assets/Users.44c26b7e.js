import{U as S}from"./users.service.a997be46.js";import{i as r,_ as F,o,c,a as n,F as k,r as v,t as d,w as u,v as h,d as q,b as R}from"./index.c631c08b.js";class x{getContacts(){return r.get("/account/contacts")}createContactRequest(s){return r.post("/account/contacts/requests",{request:{secondUserId:s}})}changeContactRequest(s,a){return r.patch("/account/contacts/requests/"+s,{request:{status:a}})}deleteContactRequest(s){return r.delete("/account/contacts/requests/"+s)}deleteFromContacts(s){return r.delete("/account/contacts/requests/active/"+s)}}var g=new x;const O={name:"Users",data(){return{users:[]}},mounted(){S.getAll().then(e=>{this.users=e.data.users,console.log(e.data)},e=>{this.content=e.response&&e.response.data&&e.response.data.message||e.message||e.toString()})},methods:{approveRequest(e){e.loading=!0,g.changeContactRequest(e.contactRequestFirstUser[0].id,!0).then(s=>{this.users[this.users.indexOf(e)].contactRequestFirstUser[0].status=!0,this.users[this.users.indexOf(e)].loading=!1},s=>{console.log("error approving request"),this.users[this.users.indexOf(e)].loading=!1})},createContactRequest(e){e.loading=!0,g.createContactRequest(e.id).then(s=>{this.users[this.users.indexOf(e)].contactRequestSecondUser=[{id:s.data.request.id,status:null}],this.users[this.users.indexOf(e)].loading=!1},s=>{console.log("error approving request"),this.users[this.users.indexOf(e)].loading=!1})},deleteContactRequest(e){e.loading=!0,g.deleteContactRequest(e.contactRequestSecondUser[0].id).then(s=>{this.users[this.users.indexOf(e)].contactRequestSecondUser=null,this.users[this.users.indexOf(e)].loading=!1},s=>{console.log("error deleting request"),this.users[this.users.indexOf(e)].loading=!1})},deleteFromContacts(e){e.loading=!0,console.log(e.contactRequestFirstUser,e.contactRequestSecondUser);const s=!!e.contactRequestFirstUser,a=!!e.contactRequestSecondUser;let i;s&&e.contactRequestFirstUser?i=e.contactRequestFirstUser[0].id:a&&e.contactRequestSecondUser&&(i=e.contactRequestSecondUser[0].id),g.deleteFromContacts(i).then(p=>{s&&(this.users[this.users.indexOf(e)].contactRequestFirstUser=null),a&&(this.users[this.users.indexOf(e)].contactRequestSecondUser=null),this.users[this.users.indexOf(e)].loading=!1},p=>{console.log("error deleting request"),this.users[this.users.indexOf(e)].loading=!1})}}},y={class:"container"},w=n("header",{class:"jumbotron"},[n("h3",null," Users ")],-1),A={class:"list-group"},N=["onClick","disabled"],D={class:"spinner-border spinner-border-sm"},$=R(" Add to contacts "),B=["onClick","disabled"],V={class:"spinner-border spinner-border-sm"},j=R(" Delete request "),E=["onClick","disabled"],I={class:"spinner-border spinner-border-sm"},L=R(" Delete from contacts "),T=["onClick","disabled"],z={class:"spinner-border spinner-border-sm"},G=R(" Approve request ");function H(e,s,a,i,p,l){return o(),c("div",y,[w,n("ul",A,[(o(!0),c(k,null,v(p.users,(t,C)=>{var b,U,f,m;return o(),c("li",{class:"list-group-item",key:C},[n("p",null,d(t.firstName)+" "+d(t.lastName),1),n("p",null,d(t.username),1),n("p",null,d(t.email),1),!t.contactRequestFirstUser&&!t.contactRequestSecondUser?(o(),c("button",{key:0,class:"btn btn-primary btn-block",onClick:_=>l.createContactRequest(t),disabled:t.loading},[u(n("span",D,null,512),[[h,t.loading]]),$],8,N)):q("",!0),!t.contactRequestFirstUser&&t.contactRequestSecondUser&&((b=t.contactRequestSecondUser[0])==null?void 0:b.status)===null?(o(),c("button",{key:1,class:"btn btn-danger btn-block",onClick:_=>l.deleteContactRequest(t),disabled:t.loading},[u(n("span",V,null,512),[[h,t.loading]]),j],8,B)):q("",!0),!t.contactRequestFirstUser&&t.contactRequestSecondUser&&((U=t.contactRequestSecondUser[0])==null?void 0:U.status)===!0||!t.contactRequestSecondUser&&t.contactRequestFirstUser&&((f=t.contactRequestFirstUser[0])==null?void 0:f.status)===!0?(o(),c("button",{key:2,class:"btn btn-warning btn-block",onClick:_=>l.deleteFromContacts(t),disabled:t.loading},[u(n("span",I,null,512),[[h,t.loading]]),L],8,E)):q("",!0),t.contactRequestFirstUser&&((m=t.contactRequestFirstUser[0])==null?void 0:m.status)===null&&!t.contactRequestSecondUser?(o(),c("button",{key:3,class:"btn btn-primary btn-block",onClick:_=>l.approveRequest(t),disabled:t.loading},[u(n("span",z,null,512),[[h,t.loading]]),G],8,T)):q("",!0)])}),128))])])}var M=F(O,[["render",H]]);export{M as default};
